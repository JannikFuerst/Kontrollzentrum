<div class="modal-overlay" id="modalOverlay" aria-hidden="true">
  <div class="modal" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
    <div class="modal-head">
      <div class="modal-title" id="modalTitle" data-i18n="modal_add_title">Neue App hinzufügen</div>
      <button class="icon-btn" id="modalClose" type="button" aria-label="Schließen" data-i18n-aria-label="close_aria">&times;</button>
    </div>
    <div class="modal-body">
      <div class="field">
        <div style="display:flex;align-items:center;justify-content:space-between;gap:12px;margin-top:10px;">
          <div class="icon-tile selected" style="width:52px;height:52px;border-radius:14px;">
            <img id="iconPreviewImg" class="icon-img" alt="">
          </div>
          <div style="display:flex;gap:8px;">
            <button class="icon-btn" id="iconRemove" type="button" aria-label="Icon entfernen" data-tip="Icon entfernen" data-i18n-aria-label="modal_icon_remove">🗑️</button>
            <button class="icon-btn" id="iconUploadBtn" type="button" aria-label="Icon hochladen" data-tip="Icon hochladen (JPG/PNG)" data-i18n-aria-label="modal_icon_upload">⬆️</button>
          </div>
        </div>

        <input id="iconUpload" type="file" accept="image/png,image/jpeg,image/jpg,image/webp" hidden />
      </div>

      <div class="field">
        <div class="label" data-i18n="modal_name_label">Name</div>
        <input class="input" id="appName" placeholder="z.B. Notion / Discord" data-i18n-placeholder="modal_name_placeholder" />
      </div>

      <div class="row2">
        <div class="field">
          <div class="label" data-i18n="modal_type_label">Typ</div>
          <div class="type-toggle-wrap">
            <button class="type-toggle-btn" id="appTypeToggleBtn" type="button" aria-label="Typ wechseln">
              <span id="appTypeToggleLabel">Desktop (Scan Vorschläge)</span>
            </button>
            <select class="select hidden" id="appType">
              <option value="web" data-i18n="modal_type_web">Web (https://...)</option>
              <option value="scan" selected data-i18n="modal_type_scan">Desktop (Scan Vorschläge)</option>
            </select>
          </div>
        </div>

        <div class="field">
          <div class="label" data-i18n="modal_category_label">Kategorie</div>
          <div class="category-select-wrap">
            <button class="category-select-button" id="appCategoryButton" type="button" aria-haspopup="listbox" aria-expanded="false">
              <span class="category-select-label" id="appCategoryLabel">Sonstiges</span>
            </button>
            <div class="category-select-menu hidden" id="appCategoryMenu" role="listbox"></div>
            <select class="select select-category hidden" id="appCategory"></select>
          </div>
        </div>
      </div>

      <div class="field" id="launchField">
        <div class="label" id="launchLabel" data-i18n="modal_url_label">URL <span class="req">*</span></div>
        <input class="input" id="appUrl" placeholder="https://..." data-i18n-placeholder="modal_url_placeholder" />
        <div id="launchHelp" class="help-text">
          <span data-i18n="modal_url_example">Beispiel: https://notion.so</span>
        </div>
      </div>

      <div class="field hidden" id="scanField">
        <div class="label" data-i18n="modal_found_apps">Gefundene Apps</div>
        <div class="scan-row">
          <div class="category-select-wrap scan-select-wrap">
            <button class="category-select-button" id="scanSelectButton" type="button" aria-haspopup="listbox" aria-expanded="false">
              <span class="category-select-label" id="scanSelectLabel"></span>
            </button>
            <div class="category-select-menu hidden" id="scanSelectMenu" role="listbox"></div>
            <select class="select hidden" id="scanSelect"></select>
          </div>
          <button class="icon-btn scan-refresh" id="scanRefresh" type="button" title="Scan aktualisieren" aria-label="Scan aktualisieren" data-i18n-title="modal_scan_refresh" data-i18n-aria-label="modal_scan_refresh">&#8635;</button>
        </div>
        <div class="scan-loading hidden" id="scanLoading">
          <span class="dot"></span><span class="dot"></span><span class="dot"></span>
        </div>
      </div>

      <div class="field">
        <div class="label" data-i18n="modal_app_hotkey_label">App Hotkey</div>
        <div class="modal-hotkey-row">
          <input class="input" id="appHotkey" placeholder="Drücke 'Aufnehmen'..." data-i18n-placeholder="modal_app_hotkey_placeholder" readonly />
          <button class="btn-ghost modal-hotkey-capture" id="appHotkeyCapture" type="button" data-i18n="settings_capture">Aufnehmen</button>
          <button class="icon-btn modal-hotkey-clear" id="appHotkeyClear" type="button" aria-label="Hotkey entfernen" data-tip="Hotkey entfernen" data-i18n-aria-label="modal_app_hotkey_clear">×</button>
        </div>
      </div>
    </div>

    <div class="modal-foot">
      <button class="btn-ghost" id="cancelBtn" type="button" data-i18n="cancel">Abbrechen</button>
      <button class="btn-primary" id="submitBtn" type="button" data-i18n="add">Hinzufügen</button>
    </div>
  </div>
</div>

<div class="modal-overlay" id="confirmOverlay" aria-hidden="true">
  <div class="modal modal-confirm" role="dialog" aria-modal="true" aria-labelledby="confirmTitle">
    <div class="modal-head">
      <div class="modal-title" id="confirmTitle" data-i18n="confirm_delete_default_title">Löschen bestätigen</div>
      <button class="icon-btn" id="confirmClose" type="button" aria-label="Schließen" data-i18n-aria-label="close_aria">&times;</button>
    </div>
    <div class="modal-body">
      <div class="confirm-text" id="confirmText" data-i18n="confirm_delete_default_message">Möchtest du diese App wirklich löschen?</div>
    </div>
    <div class="modal-foot">
      <button class="btn-ghost" id="confirmCancel" type="button" data-i18n="cancel">Abbrechen</button>
      <button class="btn-primary" id="confirmOk" type="button" data-i18n="confirm_delete_default_label">Löschen</button>
    </div>
  </div>
</div>

<div class="modal-overlay" id="catManageOverlay" aria-hidden="true">
  <div class="modal" role="dialog" aria-modal="true" aria-labelledby="catManageTitle">
    <div class="modal-head">
      <div class="modal-title" id="catManageTitle" data-i18n="cat_manage_title">Kategorien verwalten</div>
      <button class="icon-btn" id="catManageClose" type="button" aria-label="Schließen" data-i18n-aria-label="close_aria">&times;</button>
    </div>
    <div class="modal-body">
      <div class="field">
        <div class="cat-kind-switch" id="catKindSwitch" role="tablist" aria-label="Kategorie Typ">
          <button class="cat-kind-btn" id="catKindSuper" type="button" data-kind="super" role="tab" aria-selected="false" data-i18n="cat_kind_super">Überkategorie</button>
          <button class="cat-kind-btn active" id="catKindSub" type="button" data-kind="sub" role="tab" aria-selected="true" data-i18n="cat_kind_sub">Unterkategorie</button>
        </div>
        <div class="label" data-i18n="cat_new_label">Neue Kategorie</div>
        <div class="row2 cat-manage-row">
          <button class="cat-super-icon-pick hidden" id="catSuperIconPick" type="button" aria-label="Icon waehlen">
            <span class="cat-super-icon-mark" id="catSuperIconMark">?</span>
          </button>
          <input class="input" id="catManageInput" placeholder="z.B. Lernen, Finanzen..." data-i18n-placeholder="cat_new_placeholder" />
          <button class="btn-primary" id="catManageAdd" type="button" data-i18n="add">Hinzufügen</button>
        </div>
      </div>
      <div class="field">
        <div class="label" data-i18n="cat_existing_label">Vorhandene Kategorien</div>
        <div class="cat-manage-list" id="catManageList"></div>
      </div>
    </div>
    <div class="modal-foot">
      <button class="btn-ghost" id="catManageCancel" type="button" data-i18n="close">Schließen</button>
    </div>
  </div>
</div>

<div class="modal-overlay" id="superIconOverlay" aria-hidden="true">
  <div class="modal" role="dialog" aria-modal="true" aria-labelledby="superIconTitle">
    <div class="modal-head">
      <div class="modal-title" id="superIconTitle" data-i18n="super_icon_title">Icon waehlen</div>
      <button class="icon-btn" id="superIconClose" type="button" aria-label="Schliessen" data-i18n-aria-label="close_aria">&times;</button>
    </div>
    <div class="modal-body">
      <div class="label" id="superIconForLabel">Ueberkategorie</div>
      <div class="super-icon-preview" id="superIconPreview" aria-hidden="true">?</div>
      <div class="super-icon-search">
        <input id="superIconSearch" class="input" type="text" data-i18n-placeholder="super_icon_search_placeholder" placeholder="Icons durchsuchen..." />
      </div>
      <div class="super-icon-grid" id="superIconGrid"></div>
      <div class="help-text super-icon-empty hidden" id="superIconEmpty" data-i18n="super_icon_empty">Keine passenden Icons gefunden.</div>
      <div class="super-icon-upload-row">
        <button class="btn-ghost" id="superIconUploadBtn" type="button" data-i18n="super_icon_upload">Eigenes Icon hochladen</button>
        <input id="superIconUpload" type="file" accept="image/png,image/jpeg,image/jpg,image/webp,image/svg+xml" hidden />
      </div>
    </div>
    <div class="modal-foot">
      <button class="btn-ghost" id="superIconCancel" type="button" data-i18n="cancel">Abbrechen</button>
      <button class="btn-primary" id="superIconSave" type="button" data-i18n="super_icon_use">Verwenden</button>
    </div>
  </div>
</div>

<div class="modal-overlay" id="settingsOverlay" aria-hidden="true">
  <div class="modal modal-settings" role="dialog" aria-modal="true" aria-labelledby="settingsTitle">
    <div class="modal-head">
      <div class="modal-title" id="settingsTitle" data-i18n="settings_title">Einstellungen</div>
      <button class="icon-btn" id="settingsClose" type="button" aria-label="Schließen" data-i18n-aria-label="close_aria">&times;</button>
    </div>
    <div class="modal-body">
      <div class="field">
        <div class="label" data-i18n="settings_hotkey_label">Hotkey (App ein/ausblenden)</div>
        <div class="row2">
          <input class="input" id="hotkeyInput" placeholder="Drücke 'Aufnehmen'…" data-i18n-placeholder="settings_hotkey_placeholder" readonly />
          <button class="btn-primary" id="hotkeyCapture" type="button" data-i18n="settings_capture">Aufnehmen</button>
        </div>
      </div>
      <div class="field">
        <div class="label" data-i18n="settings_clipboard_label">Clipboard Verlauf</div>
        <div class="clipboard-mode-toggle" id="clipboardModeToggle" role="group" aria-label="Clipboard Modus">
          <button class="clipboard-mode-btn" id="clipboardModeCountBtn" type="button" data-mode="count" aria-label="Nach Anzahl löschen">🔢</button>
          <button class="clipboard-mode-btn" id="clipboardModeTimeBtn" type="button" data-mode="time" aria-label="Nach Zeit löschen">🕒</button>
        </div>
        <input type="hidden" id="clipboardRetentionMode" value="count" />
        <div class="clipboard-setting-extra hidden" id="clipboardTimeWrap">
          <div class="label" data-i18n="settings_clip_time_window">Zeitfenster</div>
          <div class="clipboard-option-row" id="clipboardTimeButtons" role="group" aria-label="Zeitfenster">
            <button class="clipboard-option-btn" type="button" data-value="4">4</button>
            <button class="clipboard-option-btn" type="button" data-value="8">8</button>
            <button class="clipboard-option-btn" type="button" data-value="24">24</button>
            <button class="clipboard-option-btn" type="button" data-value="48">48</button>
          </div>
          <input type="hidden" id="clipboardTimeCycle" value="24" />
        </div>
        <div class="clipboard-setting-extra hidden" id="clipboardCountWrap">
          <div class="label" data-i18n="settings_clip_max">Max. Einträge</div>
          <div class="clipboard-option-row" id="clipboardCountButtons" role="group" aria-label="Max. Einträge">
            <button class="clipboard-option-btn" type="button" data-value="5">5</button>
            <button class="clipboard-option-btn" type="button" data-value="10">10</button>
            <button class="clipboard-option-btn" type="button" data-value="25">25</button>
            <button class="clipboard-option-btn" type="button" data-value="50">50</button>
          </div>
          <input type="hidden" id="clipboardMaxItems" value="25" />
        </div>
      </div>
      <div class="field">
        <div class="label" data-i18n="settings_accent">Akzentfarbe</div>
        <div class="accent-row" id="accentRow">
          <button class="accent-btn" data-accent="purple"></button>
          <button class="accent-btn" data-accent="blue"></button>
          <button class="accent-btn" data-accent="green"></button>
          <button class="accent-btn" data-accent="pink"></button>
          <button class="accent-btn" data-accent="red"></button>
          <button class="accent-custom-trigger" id="accentCustomTrigger" type="button" aria-label="Individuelle Farbe">🎨</button>
        </div>
        <div class="accent-custom-overlay hidden" id="accentCustomOverlay" aria-hidden="true">
          <div class="accent-custom accent-custom-popup" id="accentCustom">
            <div class="accent-custom-head">
              <div class="label" data-i18n="settings_accent_custom">Individuelle Farbe</div>
              <button class="icon-btn accent-custom-close" id="accentCustomClose" type="button" aria-label="Schließen">&times;</button>
            </div>
            <div class="accent-wheel-wrap" id="accentWheelWrap">
              <canvas id="accentWheel" width="220" height="220" aria-label="Akzent Farbrad"></canvas>
              <span class="accent-wheel-thumb" id="accentWheelThumb"></span>
            </div>
            <div class="accent-brightness-row">
              <div class="label" data-i18n="settings_accent_brightness">Helligkeit</div>
              <input type="range" id="accentBrightness" min="40" max="140" step="1" value="100" />
            </div>
          </div>
        </div>
      </div>
      <div class="field">
        <div class="label" data-i18n="settings_background">Hintergrund</div>
        <div class="bg-choices" id="bgChoices">
          <label class="bg-choice">
            <input type="radio" name="bgMode" value="theme" />
            <span class="bg-thumb bg-theme"></span>
            <span class="bg-label" data-i18n="settings_bg_standard">Standard</span>
          </label>
          <label class="bg-choice">
            <input type="radio" name="bgMode" value="mono" />
            <span class="bg-thumb bg-mono"></span>
            <span class="bg-label" data-i18n="settings_bg_mono">Mono</span>
          </label>
          <label class="bg-choice bg-choice-duo">
            <input type="radio" name="bgMode" value="duo" />
            <span class="bg-thumb bg-duo"></span>
            <span class="bg-label" data-i18n="settings_bg_duo">Duo</span>
          </label>
          <label class="bg-choice">
            <input type="radio" name="bgMode" value="custom" />
            <span class="bg-thumb bg-custom"></span>
            <span class="bg-label" data-i18n="settings_bg_custom">Custom</span>
          </label>
        </div>
        <div class="bg-duo hidden" id="bgDuoControls">
          <div class="label" data-i18n="settings_duo_colors">Duo Farben</div>
          <div class="bg-duo-row">
            <span class="bg-duo-label" data-i18n="settings_duo_top">Oben rechts</span>
            <div class="bg-duo-palette" id="bgDuoTop"></div>
          </div>
          <div class="bg-duo-row">
            <span class="bg-duo-label" data-i18n="settings_duo_bottom">Unten links</span>
            <div class="bg-duo-palette" id="bgDuoBottom"></div>
          </div>
        </div>
        <div class="bg-upload hidden" id="bgUploadRow">
          <input class="input" id="bgUploadName" placeholder="Kein Bild gewaehlt" data-i18n-placeholder="settings_no_image" readonly />
          <button class="btn-primary" id="bgUploadBtn" type="button" data-i18n="settings_upload_image">Bild hochladen</button>
          <input id="bgUpload" type="file" accept="image/png,image/jpeg,image/jpg,image/webp" hidden />
        </div>
        <div class="error-box hidden" id="bgError" data-i18n="settings_bg_error">Bild hat falsches Format. Bitte 1920x1080, 2560x1440, 3840x2160 oder 5184x3456 verwenden.</div>
      </div>
    </div>
    <div class="modal-foot">
      <button class="btn-ghost" id="hotkeyCancel" type="button" data-i18n="cancel">Abbrechen</button>
      <button class="btn-primary" id="hotkeySave" type="button" data-i18n="save">Speichern</button>
    </div>
  </div>
</div>

<div class="modal-overlay" id="voiceSettingsOverlay" aria-hidden="true">
  <div class="modal modal-settings" role="dialog" aria-modal="true" aria-labelledby="voiceSettingsTitle">
    <div class="modal-head">
      <div class="modal-title" id="voiceSettingsTitle" data-i18n="voice_settings_title">Sprachsteuerung</div>
      <button class="icon-btn" id="voiceSettingsClose" type="button" aria-label="Schließen" data-i18n-aria-label="close_aria">&times;</button>
    </div>
    <div class="modal-body">
      <div class="field">
        <div class="label" data-i18n="settings_voice_activation">Sprachaktivierung</div>
        <div class="theme-row">
          <div class="voice-activation-choice" role="group" aria-label="Sprachaktivierung Zustand">
            <button class="voice-activation-btn is-off" id="voiceActivationOff" type="button" data-i18n="settings_voice_status_off">Deaktiviert</button>
            <button class="voice-activation-btn is-on" id="voiceActivationOn" type="button" data-i18n="settings_voice_status_on">Aktiviert</button>
          </div>
          <input type="checkbox" id="voiceActivationToggle" hidden />
        </div>
      </div>
      <div class="field hidden" id="voiceMicWrap">
        <div class="label" data-i18n="settings_voice_mic">Mikrofon</div>
        <select class="select" id="voiceMicSelect"></select>
      </div>
      <div class="field" id="voiceWakeCustomWrap">
        <div class="label" data-i18n="settings_voice_wake_label">Ansprech-String</div>
        <input class="input" id="voiceWakeInput" data-i18n-placeholder="settings_voice_wake_placeholder" placeholder="z.B. Kontrollzentrum, Control Center" />
      </div>
      <div class="field">
        <div class="label" data-i18n="settings_voice_voice">Stimme</div>
        <button class="voice-mode-btn" id="voiceModeBtn" type="button" aria-label="Stimme auswählen">
          <span class="voice-mode-icon" id="voiceModeIcon" aria-hidden="true">🎵</span>
        </button>
      </div>
    </div>
    <div class="modal-foot">
      <button class="btn-ghost" id="voiceSettingsCancel" type="button" data-i18n="cancel">Abbrechen</button>
      <button class="btn-primary" id="voiceSettingsSave" type="button" data-i18n="save">Speichern</button>
    </div>
  </div>
</div>






